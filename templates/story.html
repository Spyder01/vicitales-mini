<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{.Title}} | Suhan's Stories</title>
  <link href="../../static/css/style.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Fira+Code&display=swap" rel="stylesheet">
</head>
<body>
    <header>
      <h1>{{.Title}}</h1>
      <hr />
    </header>

		<div id="views-container">
			<span class="eye">ğŸ‘ï¸</span>
			<span id="views-count">--</span>
		</div>

    <article>
      {{.Content}}
    </article>

    {{if or .PrevLink .NextLink}}
    <nav class="story-nav">
      {{if .PrevLink}}
        <a href="{{.PrevLink}}" class="nav-btn prev-btn">â† Previous</a>
      {{end}}
      {{if .NextLink}}
        <a href="{{.NextLink}}" class="nav-btn next-btn">Next â†’</a>
      {{end}}
    </nav>
    {{end}}

    <footer>
      <p>Â© {{.Year}} Suhan Bangera</p>
    </footer>
		<script>
			const WORKER_URL = "https://counter-api.suhan01-bangera.workers.dev";  

			// Auto-generate a unique key based on page URL (or .Title)
			const path = window.location.pathname.replace(/\//g, "_"); 
			const namespace = "stories"; // you can change this
			const key = path || "index";

			// Build API URL
			const api = `${WORKER_URL}/hit/${namespace}/${key}`;

			fetch(api)
				.then(r => r.json())
				.then(data => {
					document.getElementById("views-count").textContent = data.value;
				})
				.catch(() => {
					document.getElementById("views-count").textContent = "0";
				});
		</script>
</body>
</html>
